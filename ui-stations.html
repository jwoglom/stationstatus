<!doctype html>
<html>
<head>
    <title>StationStatus</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=1">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,600,300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="ui.core.css" />
    <link rel="stylesheet" type="text/css" href="ui.card.css" />
    <link rel="stylesheet" type="text/css" href="ui.card.trip.css" />
    <link rel="stylesheet" type="text/css" href="ui.card.closest.css" />
    <link rel="stylesheet" type="text/css" href="ui.card.lines.css" />
    <link rel="stylesheet" type="text/css" href="ui.card.stations.css" />
    <link rel="stylesheet" type="text/css" href="ui.allstations.css" />
    


    <script type="text/javascript" src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="oop.js"></script>
    <script type="text/javascript" src="geo.js"></script>
    <script type="text/javascript" src="ui.js"></script>
    <script type="text/javascript">
    $(function() {
        metro = new Rail({
            DisplayName: "Washington Metro"
        });
        var _st = +new Date;
        WMATA.getblob(function() {
            metro.fill();
            console.info("Load time: "+(+new Date - _st)+"ms");
            stationsInit();
        });

        assign(".logo", "ui-home.html");

        stationsInit = function() {
            var st = +new Date;
            var stns = [];
            for(code in metro.stations) {
                stns.push(metro.stations[code]);
            }
            // Sort alphabetically
            stns.sort(function(a, b) {
                return a.name > b.name ? 1 : -1;
            });
            for(var i=0; i<stns.length; i++) {
                addStation(stns[i]);
            }
            $(".loading").hide();
            console.debug("Sorted in "+(+new Date - st)+"ms");
        }
        addStation = function(st) {
            var str = '<li class="card' + (st.transfer ? ' transfer' : '') + '" data-station="' + st.code + '" data-lines="">\n' +
                      st.name + '\n' +
                      '<div class="lines">\n';
            for(var i=0; i<st.totalLines.length; i++) {
                var ln = st.totalLines[i];
                str +='<span class="' + ln.code.toLowerCase() + '">' + ln.code + '</span>\n';
                str = str.replace('data-lines="', 'data-lines=",' + ln.code);
            }
            str +=    '</div>\n</li>';
            // Remove leading , in lines list
            str = str.replace('data-lines=",', 'data-lines="');
            $(".contents ul.allstations").append(str);
        }
    });
    </script>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="logo back">
            M
        </div>
        <div class="title">All Stations</div>
        <div class="search">
            <div class="search-icon">&#9906;</div>
            <input type="search" />
        </div>
    </div>

    <div class="contents">
        <ul class="metrograph allstations">
            <div class="loading"></div>
            <!-- <li class="card">
                Vienna
                <div class="lines">
                    <span class="or">OR</span>
                </div>
            </li>
            <li class="card transfer">
                Rosslyn
                <div class="lines">
                    <span class="or">OR</span>
                    <span class="sv">SV</span>
                    <span class="bl">BL</span>
                </div>
            </li> -->
        </ul>


    </div>
</div>
</body>
</html>